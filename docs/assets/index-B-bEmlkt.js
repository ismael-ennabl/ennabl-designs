import{r as i,j as g}from"./iframe-LWRVmnFj.js";import{c as h}from"./index-Dc_FVRD7.js";import{P as R,d as _}from"./index-gdvdVdh-.js";import{u as x}from"./index-DPcGnTxN.js";import{u as m}from"./index-C-4RrRRl.js";function U(n,e=globalThis?.document){const t=m(n);i.useEffect(()=>{const o=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",o,{capture:!0}),()=>e.removeEventListener("keydown",o,{capture:!0})},[t,e])}var j="DismissableLayer",p="dismissableLayer.update",z="dismissableLayer.pointerDownOutside",H="dismissableLayer.focusOutside",C,T=i.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),K=i.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:o,onPointerDownOutside:s,onFocusOutside:c,onInteractOutside:f,onDismiss:d,...E}=n,a=i.useContext(T),[u,F]=i.useState(null),l=u?.ownerDocument??globalThis?.document,[,I]=i.useState({}),S=x(e,r=>F(r)),b=Array.from(a.layers),[W]=[...a.layersWithOutsidePointerEventsDisabled].slice(-1),k=b.indexOf(W),D=u?b.indexOf(u):-1,A=a.layersWithOutsidePointerEventsDisabled.size>0,P=D>=k,N=Y(r=>{const v=r.target,L=[...a.branches].some(y=>y.contains(v));!P||L||(s?.(r),f?.(r),r.defaultPrevented||d?.())},l),O=q(r=>{const v=r.target;[...a.branches].some(y=>y.contains(v))||(c?.(r),f?.(r),r.defaultPrevented||d?.())},l);return U(r=>{D===a.layers.size-1&&(o?.(r),!r.defaultPrevented&&d&&(r.preventDefault(),d()))},l),i.useEffect(()=>{if(u)return t&&(a.layersWithOutsidePointerEventsDisabled.size===0&&(C=l.body.style.pointerEvents,l.body.style.pointerEvents="none"),a.layersWithOutsidePointerEventsDisabled.add(u)),a.layers.add(u),w(),()=>{t&&a.layersWithOutsidePointerEventsDisabled.size===1&&(l.body.style.pointerEvents=C)}},[u,l,t,a]),i.useEffect(()=>()=>{u&&(a.layers.delete(u),a.layersWithOutsidePointerEventsDisabled.delete(u),w())},[u,a]),i.useEffect(()=>{const r=()=>I({});return document.addEventListener(p,r),()=>document.removeEventListener(p,r)},[]),g.jsx(R.div,{...E,ref:S,style:{pointerEvents:A?P?"auto":"none":void 0,...n.style},onFocusCapture:h(n.onFocusCapture,O.onFocusCapture),onBlurCapture:h(n.onBlurCapture,O.onBlurCapture),onPointerDownCapture:h(n.onPointerDownCapture,N.onPointerDownCapture)})});K.displayName=j;var M="DismissableLayerBranch",X=i.forwardRef((n,e)=>{const t=i.useContext(T),o=i.useRef(null),s=x(e,o);return i.useEffect(()=>{const c=o.current;if(c)return t.branches.add(c),()=>{t.branches.delete(c)}},[t.branches]),g.jsx(R.div,{...n,ref:s})});X.displayName=M;function Y(n,e=globalThis?.document){const t=m(n),o=i.useRef(!1),s=i.useRef(()=>{});return i.useEffect(()=>{const c=d=>{if(d.target&&!o.current){let E=function(){B(z,t,a,{discrete:!0})};const a={originalEvent:d};d.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=E,e.addEventListener("click",s.current,{once:!0})):E()}else e.removeEventListener("click",s.current);o.current=!1},f=window.setTimeout(()=>{e.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(f),e.removeEventListener("pointerdown",c),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>o.current=!0}}function q(n,e=globalThis?.document){const t=m(n),o=i.useRef(!1);return i.useEffect(()=>{const s=c=>{c.target&&!o.current&&B(H,t,{originalEvent:c},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>o.current=!0,onBlurCapture:()=>o.current=!1}}function w(){const n=new CustomEvent(p);document.dispatchEvent(n)}function B(n,e,t,{discrete:o}){const s=t.originalEvent.target,c=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(n,e,{once:!0}),o?_(s,c):s.dispatchEvent(c)}export{K as D};
